#!/usr/bin/env node
var debug = require('debug')('ohmpha-app');
var particle = require('../lib/particle');
var app = require('../app');
var config = require('../lib/config/config');
var Io = require('socket.io');
var addNamespace = require('../lib/sockets/helpers/addNamespace');

app.set('port', process.env.PORT || 3000);

var server = app.listen(app.get('port'), function() {
  debug('Express server listening on port ' + server.address().port);
});

var io = Io(server);
var userCount = 0;
io.set('origins', config.socket_origin);
addNamespace(io, '/chat', require('../lib/sockets/namespaces/chat'));
addNamespace(io, '/bulb', require('../lib/sockets/namespaces/bulb'));
addNamespace(io, '/circuit', require('../lib/sockets/namespaces/circuit'));
